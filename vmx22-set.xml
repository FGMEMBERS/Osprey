<?xml version="1.0" encoding="UTF-8"?>

<!-- VMX22 Osprey simulation config -->

<!--
     Sources:
        [1]  http://books.google.com/books?id=DbUhEnlI3OkC&pg=PA129 (page 113 and 129)
        [2]  http://www.globalsecurity.org/military/systems/aircraft/v-22-survive.htm
        [3]  http://www.boeing.com/ospreynews/2011/issue_02/final_2011_2012_guidebook.pdf (general characteristics, page 44)
-->

<PropertyList>

    <sim include="Nasal/views.xml">

        <author>onox (FBW, Systems), Emmanuel Baranger (3D), Maik Justus (FDM), Oliver Thurau (3D upgrade and FDM / XML upgrade)</author>
        <status>alpha</status>
        <aircraft-version>0.60-22.06.2014</aircraft-version>
    
        <flight-model>yasim</flight-model>

        <!-- Empty fuel tanks at start-up of FlightGear -->
        <fuel-fraction>0.0</fuel-fraction>

        <!-- Sources: [3] -->
        <max-payload>60500</max-payload>

        <startup>
            <splash-texture>Aircraft/VMX22-Osprey/vmx22-splash.png</splash-texture>
        </startup>

        <sound>
            <path>Aircraft/VMX22-Osprey/Sounds/v22-sound.xml</path>
        </sound>

        <model>
            <path archive="y">Aircraft/VMX22-Osprey/Models/v22.xml</path>
            
            <livery>
                <file type="string">default</file>
            </livery>
        
            <v22>
                <state type="int">0</state>
                <wing_state type="int">0</wing_state>
                <blade_folding type="float">0</blade_folding>
                <wing_rotation type="float">0</wing_rotation>
                <inputflaps type="float">0</inputflaps>
                <wingfoldincidence type="float">0</wingfoldincidence>

                <wing>
                    <elevator type ="float">0</elevator>
                    <aileron type="float">0</aileron>
                    <rudder type="float">0</rudder>
                    <flap type="float">0</flap>
                </wing>

                <rotor>
                    <left>
                        <elevator type="float">0</elevator>
                        <collective type="float">0</collective>
                        <tilt type="float">0</tilt>
                        <animation_tilt type="float">0</animation_tilt>
                    </left>
                    <right>
                        <elevator type="float">0</elevator>
                        <collective type="float">0</collective>
                        <tilt type="float">0</tilt>
                        <animation_tilt type="float">0</animation_tilt>
                    </right>
                </rotor>
                
                <engine_right type="float">0.0</engine_right>
                <engine_left type="float">0.0</engine_left>
                <rotor-step-deg type="float">-1.0</rotor-step-deg>
                <wing_rotation_speed type ="float">0</wing_rotation_speed>
                <flap_speed type="float">0</flap_speed>
                <blade_folding_speed type="float">0</blade_folding_speed>
                <animation_tilt_speed type="float">0</animation_tilt_speed>
            </v22>
        
            <!-- set for landing lights OFF (0 default) on startup <property>sim/model/lights/landing-lights/state</property> -->
            <!-- set for GIT landing lights OFF (0 default) on startup <property>sim/model/lights/git-landing-lights/state</property> -->
            <!-- change state to 1 - to globaly set the GIT landing lights to ON for all mp vmx22 -->
            <lights>
                <landing-lights>
                    <state type="int">0</state>
                </landing-lights>
                <git-landing-lights>
                    <state type="int">0</state>
                </git-landing-lights>
            </lights>
        </model>

        <multiplay>
            <generic>
                <float n="0"/>
                <float n="1"/>
                <float n="2"/>
                <float n="3"/>
                <float n="4"/>
                <float n="5"/> <!-- door mp - cargodoormix - down -->
                <float n="6"/> <!-- door mp - cargodoorup -->
                <float n="7"/> <!-- door mp - airrefuel -->
                <float n="8"/> <!-- door mp - cockpit -->
                <float n="9"/> <!-- door mp - crew -->
                <float n="10"/> <!-- door mp - crewup -->
                <float n="11"/> <!-- gear agl meter mp - rotor particles animation -->
                <float n="12"/> <!-- front gear caster mp - gear[0]/caster-angle-deg rotation animation -->
                <!-- TODO 13 not defined? -->
                <float n="14"/> <!-- collective left mp - rotor particles animation -->
                <float n="15"/> <!-- collective right mp - rotor particles animation -->
                <float n="16"/> <!-- landing lights animation mp - landing lights model position -->
                <float n="17"/> <!-- pushback animation mp - position -->
                <float n="18"/> <!-- Front gear A spin mp - gear[0]/rollspeed-ms -->
                <float n="19"/> <!-- Left gear G spin mp - gear[1]/rollspeed-ms -->
                <float n="20"/> <!-- Right gear D spin mp - gear[2]/rollspeed-ms -->
                <int n="10"/> <!-- landing lights state mp -->
                <int n="11"/> <!-- pushback state mp -->
                <int n="12"/> <!-- paratrooper jump state mp -->
            </generic>
        </multiplay>
    
        <weight n="0">
            <name>Pilot</name>
            <weight-lb>180</weight-lb>
            <max-lb>300</max-lb>
            <min-lb>150</min-lb>
        </weight>

        <weight n="1">
            <name>Co-Pilot</name>
            <weight-lb>180</weight-lb>
            <max-lb>300</max-lb>
            <min-lb>150</min-lb>
        </weight>

        <weight n="2">
            <name>Cabin Crew</name>
            <weight-lb>0</weight-lb>
            <max-lb>300</max-lb>
        </weight>

        <checklists include="v22-checklists.xml"/>

        <submodels>
            <serviceable type="bool">true</serviceable>
            <path>Aircraft/VMX22-Osprey/Submodels/submodels.xml</path>
        </submodels>

        <help include="Dialogs/v22-help.xml"/>

        <flaps>
            <setting>0.00</setting> <!-- Cruise -->
            <setting>0.33</setting> <!--  -->
            <setting>0.66</setting> <!--  -->
            <setting>1.00</setting> <!-- Full -->
        </flaps>
    
        <hitches>
            <!-- Make sure some properties do exist, when the list for multiplayer transfer is defined -->
            <!-- They need to be in the same value, as they are initilized in the FDM, to get the same values after reset should fix this somehow -->
            <aerotow>
                <tow>
                    <length type="float">30</length>
                    <elastic-constant type="float">10000</elastic-constant>
                    <weight-per-m-kg-m type="float">0.035</weight-per-m-kg-m>
                    <dist type="float">1</dist>
                    <connected-to-property-node type="bool"/>
                    <brake-force type="float">100000</brake-force>
                    <connected-to-ai-or-mp-callsign type ="string">*</connected-to-ai-or-mp-callsign>
                    <end-force-x type ="float">0</end-force-x>
                    <end-force-y type ="float">0</end-force-y>
                    <end-force-z type ="float">0</end-force-z>
                </tow>
                <speed-in-tow-direction type="float">0</speed-in-tow-direction>
                <open type="bool">true</open>
                <local-pos-x type="float">0</local-pos-x>
                <local-pos-y type="float">0</local-pos-y>
                <local-pos-z type="float">0</local-pos-z>
                <is-slave type="bool">false</is-slave>
            </aerotow>
        </hitches>

        <menubar include="Dialogs/v22-menu.xml"/>

        <systems>
            <autopilot>
                <path>Systems/servos.xml</path>
            </autopilot>
            <autopilot>
                <path>Systems/gforce.xml</path>
            </autopilot>
            <autopilot>
                <path>Systems/fbw.xml</path>
            </autopilot>
            <autopilot>
                <path>Systems/autopilot.xml</path>
            </autopilot>
        </systems>

        <hud>
            <path n="1">Aircraft/VMX22-Osprey/Hud/hud.xml</path>
            <visibility n="1">true</visibility>
            <palette>
                <color n="0">
                    <alpha type="float">0.85</alpha>
                    <antialiased type="bool">true</antialiased>
                    <brightness type="float">0.85</brightness>
                    <transparent type="bool">true</transparent>
                    <red type="float">0.38</red>
                    <green type="float">1.0</green>
                    <blue type="float">0.22</blue>
                </color>
                <color n="1">
                    <alpha type="float">0.85</alpha>
                    <antialiased type="bool">true</antialiased>
                    <brightness type="float">0.85</brightness>
                    <transparent type="bool">true</transparent>
                    <red type="float">1.0</red>
                    <green type="float">0.2</green>
                    <blue type="float">0.0</blue>
                </color>
            </palette>
        </hud>

    </sim>

    <input>
        <keyboard include="Nasal/v22-keyboard.xml"/>
        <mice include="mice.xml"/>
    </input>

    <controls>
        <aerotow>
            <find-aircraft type="bool">false</find-aircraft>
        </aerotow> 

        <lighting>
            <beacon type="bool">false</beacon>
            <nav-lights type="bool">false</nav-lights>
        </lighting>

        <gear>
            <!-- Enable parking brake when starting FlightGear -->
            <brake-parking type="double">1.0</brake-parking>
        </gear>

        <flight>
            <fbw>
                <active>
                    <roll-rate type="bool">true</roll-rate>
                    <roll-hold type="bool">false</roll-hold>

                    <pitch-rate type="bool">true</pitch-rate>
                    <pitch-hold type="bool">false</pitch-hold>

                    <yaw-rate type="bool">false</yaw-rate>

                    <bank-angle-hard-limit type="bool">true</bank-angle-hard-limit>
                </active>
                <settings>
                    <!-- 60 deg/ps due to roll-rate feedback, limited by
                         transient design limit of the interconnect
                         drive shaft load.

                         When performing a roll, the RPM of the downward
                         moving rotor increases, while the RPM of the other
                         rotor decreases. This difference increases the
                         torque transmitted through the interconnect drive
                         shaft. By using DCP (Differential Collective Pitch)
                         this load can be minimized, allowing a greater
                         maximum roll rate. For details, see [1]
                    -->
                    <roll-rate-limit type="double">60</roll-rate-limit>

                    <roll-hold-limit type="double">45</roll-hold-limit>

                    <pitch-rate-limit type="double">15</pitch-rate-limit>
                    <pitch-hold-min type="double">-40</pitch-hold-min>

                    <yaw-rate-limit type="double">25</yaw-rate-limit>

                    <!-- Maximum AoA = 35 according to YASim .xml file -->
                    <pitch-hold-max type="double">35</pitch-hold-max>

                    <!-- Fixed gains used when using Direct Mode,
                         which bypasses the Fly-By-Wire. Limited to be
                         at most 1.0.

                         direct-roll-rate-gain needs to be quite low
                         because the ailerons can produce a very high
                         roll rate.
                    -->
                    <direct-roll-rate-gain type="double">0.3</direct-roll-rate-gain>
                    <direct-pitch-rate-gain type="double">0.8</direct-pitch-rate-gain>

                    <vtol>
                        <direct-roll-rate-gain type="double">2.5</direct-roll-rate-gain>
                        <direct-yaw-rate-gain type="double">2.0</direct-yaw-rate-gain>
                        <direct-pitch-rate-gain type="double">2.5</direct-pitch-rate-gain>
                    </vtol>
                </settings>
                <target>
                    <tilt-rate type="double">0.0</tilt-rate>
                    <tilt type="double">0</tilt>
                </target>
            </fbw>
        </flight>
    </controls>

    <rotors>
        <main>
            <rpm type="double">0</rpm>
            <blade>
                <position-deg type="float">0</position-deg>
                <incidence-deg type="float">0</incidence-deg>
            </blade>
        </main>
        <tail>
            <rpm type="double">0</rpm>
            <blade>
                <position-deg type="float">0</position-deg>
                <incidence-deg type="float">0</incidence-deg>
            </blade>
        </tail>
    </rotors>

    <surface-positions>
        <flap-pos-norm type="float">0</flap-pos-norm>
    </surface-positions>
  
    <ai>
        <submodels>
            <trigger type="bool">false</trigger>
        </submodels>
    </ai>

    <gear>
        <gear n="0">
            <tyre-smoke type="int">0</tyre-smoke>
            <sprayspeed-ms type="double">0</sprayspeed-ms>
            <spray-density type="double">0</spray-density>
            <caster-angle-deg-damped type="double">0</caster-angle-deg-damped>
        </gear>
        <gear n="1">
            <tyre-smoke type="int">0</tyre-smoke>
            <sprayspeed-ms type="double">0</sprayspeed-ms>
            <spray-density type="double">0</spray-density>
        </gear>
        <gear n="2">
            <tyre-smoke type="int">0</tyre-smoke>
            <sprayspeed-ms type="double">0</sprayspeed-ms>
            <spray-density type="double">0</spray-density>
        </gear>
    </gear>
  
    <nasal>
        <lighting>
            <file>Aircraft/VMX22-Osprey/Nasal/lighting.nas</file>
        </lighting>
        <v22>
            <file>Aircraft/VMX22-Osprey/Nasal/v22.nas</file>
            <!-- <file>Aircraft/VMX22-Osprey/Nasal/terrain_under.nas</file> -->
            <file>Aircraft/VMX22-Osprey/Nasal/tyresmoke.nas</file>
            <file>Aircraft/VMX22-Osprey/Nasal/liveries.nas</file>
            <file>Aircraft/Generic/limits.nas</file>
        </v22>
        <doors>
            <file>Aircraft/VMX22-Osprey/Nasal/doors.nas</file>
        </doors>
    </nasal>

    <consumables>
        <fuel>
            <tank n="0"><name>Left Forward Sponson</name></tank>
            <tank n="1"><name>Right Forward Sponson</name></tank>
            <tank n="2"><name>Left Wing Feeder</name></tank>
            <tank n="3"><name>Right Wing Feeder</name></tank>
            <tank n="4"><name>Right Aft Sponson</name></tank>
            <tank n="5"><name>Forward MATS no. 1</name></tank>
            <tank n="6"><name>Forward MATS no. 2</name></tank>
            <tank n="7"><name>Aft MATS no. 3</name></tank>
        </fuel>
    </consumables>

    <limits>
        <mass-and-balance>
            <!-- Sources: [3] -->
            <maximum-takeoff-mass-lbs>60500</maximum-takeoff-mass-lbs>
        </mass-and-balance>

        <!-- Design requirements require envelope of speeds up to
             345 KTAS according to [1].
        -->
        <vne>345</vne>

        <!-- 140 KCAS according to [4] -->
        <max-gear-extension-speed>140</max-gear-extension-speed>

        <!-- Sources: [1] and [2] -->
        <max-positive-g>4.0</max-positive-g>
        <max-negative-g>-1.0</max-negative-g>
    </limits>
    
    <instrumentation include="Systems/instrumentation.xml"/>

</PropertyList>
